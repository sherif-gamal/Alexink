
<div class="row">
  <div id="breadcrumb" class="col-md-12">
    <ol class="breadcrumb">
      <li><a href="#">الحسابات العامة</a></li>
      <li><a href="#">إهلاك الأصول الثابتة</a></li>
    </ol>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">
    <div class="box">
      <div class="box-header">
        <div class="box-name">
          <i class="fa fa-linux"></i>
          <span>إهلاك الأصول الثابتة</span>
        </div>
        <div class="no-move"></div>
      </div>
      <div class="box-content no-padding table-responsive">
        <table class="table table-bordered table-striped table-hover table-heading">
          <thead>
            <tr>
              <th>البيان</th>
              <th>النسبة</th>
              <th>المدة</th>
              <th>قيمة الأصل</th>
              <th>مجمع إهلاك <%= Date.new(@_year, 1, 1).strftime("%Y/%m/%d")%></th>
              <th>إهلاك <%= @_year%></th>
              <th>مجمع إهلاك <Date.new(@_year, 12, 31).strftime("%Y/%m/%d")></th>
              <th>صافي قيمة الأصل</th>
            </tr>
          </thead>
          <tbody>
            <% @ehlak.each do |e| %>
              <tr>
                <input type="hidden" value="<%= e.id%>" />
                <td><input style="width: 100px;"><%= e.name %></input></td>
                <td><input style="width: 100px;"><%= e.rate %></input></td>
                <td>سنة</td>
                <td><input style="width: 100px;"><%= e.value %></input></td>
                <td><input style="width: 100px;"><%= e.last_year_acc %></input></td>
                <td><%= f  e.ehlak %></td>
                <td><%= f e.acc_ehlak %></td>
                <td><%= f e.total_value %></td>
                <td><button class="update"></td>
              </tr>
            <% end %>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
// Run Datables plugin and create 3 variants of settings
function AllTables(){
  setupTables();
  LoadSelect2Script(MakeSelect2);
}
function MakeSelect2(){
  $('select').select2();
  $('.dataTables_filter').each(function(){
    $(this).find('label input[type=text]').attr('placeholder', 'Search');
  });
}
$(document).ready(function() {
  // Load Datatables and run plugin on tables 
  LoadDataTablesScripts(AllTables);
  // Add Drag-n-Drop feature
  WinMove();

});
    $("tr[data-href]").click(function() {
  window.location = this.dataset.href;
}).hover(function() {
    $(this).toggleClass('hover');
});
var v;
$(".update").click(function(e) {
  t = e.target;
  children = t.parentNode.parentNode.children;
  id = children[0].value
  name = children[1].children[0].value
  rate = children[2].children[0].value
  value = children[4].children[0].value
  $.ajax({ url: '/wear_outs/update',
    type: 'POST',
    beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
    data: {"id": id,
           "name": name,
           "rate": rate,
           "value": value},

    success: function(response) {
      
    }
  });
});
</script>
